- name: set timezone and configure timesyncd
  hosts: "*"
  become: yes
  tasks:
    - name: set timezone
      shell: timedatectl set-timezone America/Chicago

    - name: make sure timesyncd is stopped
      systemd:
        name: systemd-timesyncd.service
        state: stopped
    
    - name: copy over the timesyncd config
      template: src=../templates/timesyncd.conf dest=/etc/systemd/timesyncd.conf

    - name: make sure timesyncd is started
      systemd:
        name: systemd-timesyncd.service
        state: started